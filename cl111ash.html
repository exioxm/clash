<!DOCTYPE html>
<html>
<head>
    <title>Clash Royale - Bug Fix Edition</title>
    <style>
        :root { --tile: 20px; --arena-w: calc(var(--tile) * 18); --arena-h: calc(var(--tile) * 32); }
        body { margin: 0; background: #111; color: white; display: flex; justify-content: center; font-family: sans-serif; }
        
        /* EXACT GRID SYSTEM */
        #arena { 
            width: var(--arena-w); height: var(--arena-h); 
            background: #27ae60; position: relative; border: 4px solid #fff; margin-top: 20px;
            background-image: linear-gradient(#2ecc71 1px, transparent 1px), linear-gradient(90deg, #2ecc71 1px, transparent 1px);
            background-size: var(--tile) var(--tile);
        }

        .river { position: absolute; top: calc(var(--tile) * 15); width: 100%; height: calc(var(--tile) * 2); background: #2980b9; z-index: 1; }
        .bridge { position: absolute; width: calc(var(--tile) * 2); height: calc(var(--tile) * 2); background: #7f8c8d; z-index: 2; top: calc(var(--tile) * 15); }

        /* ENTITY POSITIONING */
        .entity { 
            position: absolute; width: calc(var(--tile) * 2); height: calc(var(--tile) * 2); 
            display: flex; align-items: center; justify-content: center; font-size: 8px; font-weight: bold;
            border-radius: 4px; z-index: 5; transition: all 0.3s ease;
        }
        .tower { width: calc(var(--tile) * 3); height: calc(var(--tile) * 3); border: 2px solid gold; z-index: 10; }
        .blue { background: #3498db; }
        .red { background: #e74c3c; }

        /* UI */
        #ui { position: fixed; bottom: 0; width: 100%; height: 100px; background: rgba(0,0,0,0.9); display: flex; align-items: center; justify-content: center; gap: 10px; }
        .card { width: 50px; height: 70px; background: gold; color: black; border-radius: 4px; cursor: pointer; text-align: center; padding-top: 5px; font-size: 10px; }
        .card:hover { transform: scale(1.1); }
    </style>
</head>
<body>

<div id="arena" onclick="placeUnit(event)">
    <div class="river"></div>
    <div class="bridge" style="left: calc(var(--tile) * 3);"></div>
    <div class="bridge" style="right: calc(var(--tile) * 3);"></div>

    <!-- RED SIDE (Fixed Coordinates) -->
    KING</div>
    PRINCE</div>
    PRINCE</div>

    <!-- BLUE SIDE (Fixed Coordinates) -->
    KING</div>
    PRINCE</div>
    PRINCE</div>
</div>

<div id="ui">
    <div class="card" onclick="setCard('Knight')">Knight<br>3ðŸ’§</div>
    <div class="card" onclick="setCard('Giant')">Giant<br>5ðŸ’§</div>
    <div class="card" onclick="setCard('Tesla')">Tesla<br>4ðŸ’§</div>
</div>

<script>
    let currentCard = null;
    const tile = 20;

    function setCard(type) { currentCard = type; }

    function placeUnit(e) {
        if (!currentCard) return;

        const rect = document.getElementById('arena').getBoundingClientRect();
        // Snap to grid logic
        const x = Math.floor((e.clientX - rect.left) / tile) * tile;
        const y = Math.floor((e.clientY - rect.top) / tile) * tile;

        // BUG FIX: Placement Boundary (Cannot place in Red's half/river)
        if (y  {
                unit.style.top = (4 * tile) + 'px'; // Move to enemy towers
            }, 100);
        }
        currentCard = null;
    }
</script>

</body>
</html>
